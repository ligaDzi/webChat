(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{165:function(e,t,a){e.exports=a(307)},260:function(e,t){},307:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(59),o=a.n(c),u=a(10),s=a(132),l=a(131),i=a(16),m=a.n(i),p="webSocket",d=a(133),b=a(11),E=a(35),h=Object(d.a)({user:null,error:null,loading:!1}),f="".concat(p,"/").concat("auth","/AUTOENTER_REQUEST"),O="".concat(p,"/").concat("auth","/AUTOENTER_SUCCESS"),v="".concat(p,"/").concat("auth","/AUTOENTER_ERROR"),j="".concat(p,"/").concat("auth","/SIGN_UP_REQUEST"),S="".concat(p,"/").concat("auth","/SIGN_UP_SUCCESS"),w="".concat(p,"/").concat("auth","/SIGN_UP_ERROR"),x="".concat(p,"/").concat("auth","/SIGN_IN_REQUEST"),g="".concat(p,"/").concat("auth","/SIGN_IN_SUCCESS"),y="".concat(p,"/").concat("auth","/SIGN_IN_ERROR"),R="".concat(p,"/").concat("auth","/SIGN_OUT_REQUEST"),k="".concat(p,"/").concat("auth","/SIGN_OUT_SUCCESS");function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new h,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload,r=t.error;switch(a){case f:case x:case j:return e.set("loading",!0);case O:case g:case S:return e.set("loading",!1).set("user",n.user).set("error",null);case v:return e.set("loading",!1);case y:case w:return e.set("loading",!1).set("error",r);case k:return new h({});default:return e}}var N=m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/auth/autoenter");case 3:return a=e.sent,e.next=6,Object(b.b)([a,a.json]);case 6:if(!(n=e.sent).user){e.next=12;break}return e.next=10,Object(b.c)({type:O,payload:{user:n.user}});case 10:e.next=14;break;case 12:return e.next=14,Object(b.c)({type:v});case 14:e.next=20;break;case 16:return e.prev=16,e.t0=e.catch(0),e.next=20,Object(b.c)({type:v});case 20:case"end":return e.stop()}}),e,null,[[0,16]])})),T=m.a.mark((function e(t){var a,n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0={"Content-Type":"application/json"},e.next=4,Object(b.b)([JSON,JSON.stringify],{name:t.payload.name,email:t.payload.email,password:t.payload.password});case 4:return e.t1=e.sent,a={method:"POST",headers:e.t0,body:e.t1},e.next=8,fetch("/api/auth/register",a);case 8:return n=e.sent,e.next=11,Object(b.b)([n,n.json]);case 11:return r=e.sent,e.next=14,Object(b.c)(Object(E.a)("auth"));case 14:if(!r.user){e.next=19;break}return e.next=17,Object(b.c)({type:S,payload:{user:r.user}});case 17:e.next=21;break;case 19:return e.next=21,Object(b.c)({type:w,error:r.message});case 21:e.next=27;break;case 23:return e.prev=23,e.t2=e.catch(0),e.next=27,Object(b.c)({type:w,error:e.t2});case 27:case"end":return e.stop()}}),e,null,[[0,23]])})),U=m.a.mark((function e(t){var a,n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0={"Content-Type":"application/json"},e.next=4,Object(b.b)([JSON,JSON.stringify],{email:t.payload.email,password:t.payload.password});case 4:return e.t1=e.sent,a={method:"POST",headers:e.t0,body:e.t1},e.next=8,fetch("/api/auth/login",a);case 8:return n=e.sent,e.next=11,Object(b.b)([n,n.json]);case 11:return r=e.sent,e.next=14,Object(b.c)(Object(E.a)("auth"));case 14:if(!r.user){e.next=19;break}return e.next=17,Object(b.c)({type:g,payload:{user:r.user}});case 17:e.next=21;break;case 19:return e.next=21,Object(b.c)({type:y,error:r.message});case 21:e.next=27;break;case 23:return e.prev=23,e.t2=e.catch(0),e.next=27,Object(b.c)({type:y,error:e.t2});case 27:case"end":return e.stop()}}),e,null,[[0,23]])})),I=m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})),C=m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.a)([Object(b.d)(f,N),Object(b.d)(j,T),Object(b.d)(x,U),Object(b.d)(R,I)]);case 2:case"end":return e.stop()}}),e)})),G=function(){return Object(u.c)(Object(s.a)({form:l.a},"auth",_))},P=a(136),J=a.n(P),q=a(139),A=m.a.mark(Q);function Q(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.a)([C()]);case 2:case"end":return e.stop()}}),A)}var B=Object(q.a)(),z=G(),D=Object(u.a)(B,J.a),F=Object(u.e)(z,D);window.store=F,B.run(Q);var H=F,K=a(21),L=a(25),M=a(28),V=a(92),W=a(137),X=a.n(W),Y=function(){var e=Object(n.useState)(null),t=Object(V.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(null),u=Object(V.a)(o,2),s=u[0],l=u[1];Object(n.useEffect)((function(){fetch("/api/room/all").then((function(e){return e.json()})).then((function(e){return console.log("data",e)})).catch((function(e){return console.error(e)})),l(X()()),s&&s.on("news",(function(e){return c(e.greeting)}))}),[]);return r.a.createElement("div",null,r.a.createElement("h3",null,"TestRoom"),r.a.createElement("button",{onClick:function(e){return s.emit("greeting",{message:e})}},"Send"),a)},Z=function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"RoomsPage"),r.a.createElement(M.b,{path:"/rooms",exact:!0},r.a.createElement(L.b,{to:"/rooms/test"},"Test room")),r.a.createElement(M.b,{path:"/rooms/test",exact:!0},r.a.createElement(Y,null)))},$=a(129),ee=a(130),te=a(64),ae=a.n(te),ne=function(e){var t=e.input,a=e.type,n=e.meta,c=n.error,o=n.touched&&c&&r.a.createElement("div",{style:{color:"red"}},c);return r.a.createElement("div",null,r.a.createElement("label",null,t.name),r.a.createElement("input",Object.assign({},t,{type:a})),o)},re=Object(ee.a)({form:"auth",validate:function(e){var t=e.email,a=e.password,n={};return t?ae.a.validate(t)||(n.email="invalid email"):n.email="email is required",a?a.length<6&&(n.password="to short"):n.password="password is required",n}})((function(e){var t=e.handleSubmit;return r.a.createElement("div",null,r.a.createElement("h2",null,"Sign In"),r.a.createElement("form",{onSubmit:t},r.a.createElement($.a,{name:"email",component:ne}),r.a.createElement($.a,{name:"password",type:"passowrd",component:ne}),r.a.createElement(L.b,{to:"/auth/register"},"Registaration"),r.a.createElement("div",null,r.a.createElement("input",{type:"submit",value:"Send"}))))})),ce=Object(ee.a)({form:"auth",validate:function(e){var t=e.name,a=e.email,n=e.password,r={};return t?t.length>30&&(r.name="name to big"):r.name="name is required",a?ae.a.validate(a)||(r.email="invalid email"):r.email="email is required",n?n.length<6&&(r.password="password to short"):r.password="password is required",r}})((function(e){var t=e.handleSubmit;return r.a.createElement("div",null,r.a.createElement("h2",null,"Registaration"),r.a.createElement("form",{onSubmit:t},r.a.createElement($.a,{name:"name",component:ne}),r.a.createElement($.a,{name:"email",component:ne}),r.a.createElement($.a,{name:"password",type:"passowrd",component:ne}),r.a.createElement("div",null,r.a.createElement("input",{type:"submit",value:"Send"}))))}));var oe={signUp:function(e,t,a){return{type:j,payload:{name:e,email:t,password:a}}},signIn:function(e,t){return{type:x,payload:{email:e,password:t}}}},ue=Object(K.b)((function(e){return{user:e.auth.user,error:e.auth.error}}),oe)((function(e){e.user;var t=e.error,a=e.signUp,n=e.signIn,c=t&&"Error: ".concat(t);return r.a.createElement("div",null,r.a.createElement("h2",null,"AuthPage"),r.a.createElement("p",{style:{color:"red"}},c),r.a.createElement(M.b,{path:"/auth/login",exact:!0},r.a.createElement(re,{onSubmit:function(e){var t=e.email,a=e.password;return n(t,a)}})),r.a.createElement(M.b,{path:"/auth/register",exact:!0},r.a.createElement(ce,{onSubmit:function(e){var t=e.name,n=e.email,r=e.password;return a(t,n,r)}})))})),se=Object(K.b)((function(e){return{user:e.auth.user}}),{autoEnterSite:function(){return{type:f}}})((function(e){var t=e.user,a=e.autoEnterSite;Object(n.useEffect)((function(){a()}),[]);var c=!!t;console.log("isAuthenticated",c);var o=function(e){return e?r.a.createElement(M.d,null,r.a.createElement(M.b,{path:"/rooms"},r.a.createElement(Z,null)),r.a.createElement(M.a,{to:"/rooms"})):r.a.createElement(M.d,null,r.a.createElement(M.b,{path:"/auth"},r.a.createElement(ue,null)),r.a.createElement(M.a,{to:"/auth/login"}))}(c);return r.a.createElement(L.a,null,r.a.createElement("div",null,o))}));var le=function(){return r.a.createElement(K.a,{store:H},r.a.createElement(se,null))};o.a.render(r.a.createElement(le,null),document.getElementById("root"))}},[[165,1,2]]]);
//# sourceMappingURL=main.9c9ab667.chunk.js.map